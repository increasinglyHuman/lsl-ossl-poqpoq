{
  "type": "script",
  "uuid": "75e83f6c-dde1-4701-996b-717d9d667bca",
  "name": "75e83f6c-dde1-4701-996b-717d9d667bca_script",
  "description": "",
  "source": "    // The actual HUD  //\n    // --------------------------------------------\n    // --------------------------------------------\n    // declare / define global variables //\n    \n    integer pCoins = 0;\n    integer pGems = 0;\n    integer pScore = 0;\n    string vhCustomTitle       = \"Game Kit Demo: Seaside Adventure\";\n    string vhTitleOffset       = \" \\n \\nThanks for trying the Game Kit.\\nBegin by collecting some gems.\\nSearch for a shell on the beach\\nAvoid traps if you can.\";\n    string vhMessageLine       = \"\\n \\n \";\n    string vhCoinString        = \"\";\n    string vhGemString         = \"\";\n    string vhScoreString       = \"\";\n    integer vhAccessCost       = 0;\n    list pPuzzleList = [];\n    integer pHUDworn           = 0;\n    string          gsCardOneName           = \"config\";\n    string          g_sNoteCardName;\n    list            gOneCard;\n    list            g_lTempLines;\n    integer         g_iLine;\n    key             g_kQuery;\n    \n    initialize(string _action) {\n    if (_action == \"\") {\n        loadNoteCard(gsCardOneName);\n    } else if (_action == \"finish\") {\n        integer i;\n        for (i = 0; i< 7; ++i)\n        {\n            string tLineText        = llList2String(gOneCard,i);\n            if (i == 0)\n            {\n                vhAccessCost            = (integer)right(tLineText,\":\");\n            }\n            if (i == 1)\n            {\n                vhCustomTitle            = right(tLineText,\":\");\n                vhCustomTitle            = vhCustomTitle + \"\\n \";\n            }\n            if (i == 2)\n            {\n                vhTitleOffset            = right(tLineText,\":\");\n                vhTitleOffset            = vhTitleOffset + \"\\n \\n \";\n            }\n                llListen(999,\"\", \"\",\"\");\n                //llListen(reset_channel, \"\", \"\", \"\"); // RESET channel\n        \n        }\n    }\n}\n\nloadNoteCard( string _notecard ) {\n    g_lTempLines                    = [];\n    g_sNoteCardName                 = _notecard;\n    g_iLine                         = 0;\n    g_kQuery                        = llGetNotecardLine(g_sNoteCardName, g_iLine);\n\n}\n\nnotecardFinished(string _notecard){\n    if (_notecard == gsCardOneName) {\n        gOneCard                 = g_lTempLines;\n        initialize(\"finish\");\n    }\n}\n    \n    \n    // --------------------------------------------\n    // --------------------------------------------\n    // define global custom functions //\n    // these are from the lsl tutorials //\n\nstring left(string src, string divider) {\n    //llSubStringIndex\n    // find the first appearance of the divider\n    integer indexLF1 = llSubStringIndex( src, divider );\n    if(~indexLF1)\n    // check to see that the appearance falls in a positive number position\n    //string llDeleteSubString(string src, integer start, integer end)\n    // remove all of the text that falls to the right of the first divider\n    return llDeleteSubString( src, indexLF1 + llStringLength(divider)-1, -1);\n    return src;\n    \n}\n\nstring right(string src, string divider) {\n    integer index = llSubStringIndex( src, divider );\n    string tString = \"\";\n    if (~index) \n    {\n    // this fetches the string to the right of the first marker\n        tString = llDeleteSubString( src, 0, index + llStringLength(divider) - 1);\n        //llSay(0,\"whats  left \" + src);\n        // now we need to get the right half of that\n        integer indexSR1 = llSubStringIndex(tString, divider);\n        if (~indexSR1)\n        {\n            // here's the far right side of a 3 part list\n            tString = llDeleteSubString(tString, 0, indexSR1 + llStringLength(divider) - 1);\n        }\n    }\n    return tString;\n}\n\nstring center(string src, string divider) {\n    integer index = llSubStringIndex( src, divider );\n    string tString2 = \"\";\n    if(~index)\n    {\n        tString2 = llDeleteSubString( src, 0, index + llStringLength(divider) - 1);\n        integer indexC1 = llSubStringIndex(tString2, divider);\n        if (~indexC1)\n        {\n            return llDeleteSubString( tString2, indexC1 + llStringLength(divider)-1, -1); \n        }\n    }\n    return tString2;\n}\n\ndefault\n{\n     on_rez(integer start_param)\n    {\n        \n        if (llGetAttached() > 30)\n        {\n            pHUDworn = 1;\n            initialize(\"\");\n            llSetText(vhCustomTitle + vhTitleOffset + \"\\n \\n \", <0,0,0>, 1);\n        }else{\n            llSetText(\"\", <0,0,0>, 1);\n            llSay(0, (string)llGetAttached());\n        }\n        \n    }\n    state_entry()\n    {\n        initialize(\"\");\n        integer messageInt = llListen(1717, \"\", NULL_KEY, \"\" );\n        integer messageInt2 = llListen(1718, \"\", NULL_KEY, \"\" );\n        integer messageInt3 = llListen(1719, \"\", NULL_KEY, \"\");\n        integer messageInt4 = llListen(1791, \"\", NULL_KEY, \"\");\n        integer messageInt5 = llListen(1616, \"\", NULL_KEY, \"\");\n        integer messageInt6 = llListen(2654, \"\", NULL_KEY, \"\" );\n        vhCoinString        = \"\\nTOKENS: \"+(string)pCoins;\n        vhGemString         = \"\\nPRIZES: \"+(string)pGems;\n        pScore = pCoins * pGems;\n        vhScoreString       = \"\\nPOINTS: \"+(string)pScore;\n    }\n\n    touch_start(integer total_number)\n    {\n        // if they touch the scorekeeping object - readout the scores\n        vhCoinString        = \"\\nTOKENS: \"+(string)pCoins;\n        vhGemString         = \"\\nPRIZES: \"+(string)pGems;\n        pScore = pCoins * pGems;\n        vhScoreString       = \"\\nPOINTS: \"+(string)pScore;\n        if (pHUDworn == 1)\n        {\n        llSetText(vhCustomTitle+vhMessageLine+vhCoinString+vhGemString+vhScoreString, <0,0,0>, 1);\n    }else{\n        llInstantMessage(llGetOwner(),vhCustomTitle+vhMessageLine+vhCoinString+vhGemString+vhScoreString);\n    }\n    }\n    \n     listen( integer channel, string name, key id, string message )\n    {\n        if (channel == 1717)\n        //llSay(0, (string)channel + \"   \" + name + \"   \" + (string)id + \"    \" + message);\n        {\n            string mesR = right(message, \":\");\n            string mesL = left(message, \":\"); \n            string mesC = center(message, \":\");\n            integer tValue = (integer)mesR; // convert the coin string to a number\n                    //llSay(0, (string)llGetOwner());   \n                    //llSay(0, mesL); \n            if (mesL == (string)llGetOwner())\n\n            // this is the parse for hud owner messages only\n            {\n                //llSay(0, \"LINE 110: \" +(string)tValue);\n                pCoins = pCoins + tValue;\n                // fix according to positive v negative values\n                vhCoinString        = \"\\nTOKENS: \"+(string)pCoins;\n                vhGemString         = \"\\nPRIZES: \"+(string)pGems;\n                pScore = pCoins * pGems;\n                vhScoreString       = \"\\nPOINTS: \"+(string)pScore;\n                if (pHUDworn == 1)\n                    {\n                        llSetText(vhCustomTitle+vhMessageLine+mesC+vhCoinString+vhGemString+vhScoreString, <0,0,0>, 1);\n                    }else{\n                        llInstantMessage(llGetOwner(), vhCustomTitle+vhMessageLine+mesC+vhCoinString+vhGemString+vhScoreString);\n                }\n            }\n           // llSay(0, (string)pCoins);\n        }\n        \n        if (channel == 1718)\n        {\n            string mesR = right(message, \":\");\n            string mesL = left(message, \":\"); \n            string mesC = center(message, \":\");\n            integer tValue = (integer)mesR; // convert the coin string to a number\n            //llSay(0, mesL);\n            //llSay(0, (string)llGetOwner());\n            if (mesL == (string)llGetOwner())\n            {\n                if (tValue > 0) \n                {\n                    if (pCoins >= tValue) \n                    {\n                    //llSay(0, \"LINE 132: \" +(string)tValue);\n                        pCoins = pCoins - tValue;\n                        }else{\n                        pCoins = 0;\n                    }\n               }\n                vhCoinString        = \"\\nTOKENS: \"+(string)pCoins;\n                vhGemString         = \"\\nPRIZES: \"+(string)pGems;\n                pScore = pCoins * pGems;\n                vhScoreString       = \"\\nPOINTS: \"+(string)pScore;\n        \n                if (pHUDworn == 1)\n                    {\n                    llSetText(vhCustomTitle+vhMessageLine+mesC+vhCoinString+vhGemString+vhScoreString, <0,0,0>, 1);\n                    }else{\n                    llInstantMessage(llGetOwner(), vhCustomTitle+vhMessageLine+mesC+vhCoinString+vhGemString+vhScoreString);\n                }\n            }\n        }\n        \n        if (channel ==1719) \n        {\n        if (message == (string)llGetOwner())\n            {\n                 \n                if (pCoins >= vhAccessCost)\n                {\n                    pCoins = pCoins - vhAccessCost;\n                    llSay(1720, \"Y\");\n        vhCoinString        = \"\\nTOKENS: \"+(string)pCoins;\n        vhGemString         = \"\\nPRIZES: \"+(string)pGems;\n        pScore = pCoins * pGems;\n        vhScoreString       = \"\\nPOINTS: \"+(string)pScore;\n        if (pHUDworn == 1)\n        {\n                     llSetText(vhCustomTitle+vhMessageLine+\"You spent \"+ (string)vhAccessCost+ \" tokens to use this object.\" +vhCoinString+vhGemString+vhScoreString, <0,0,0>, 1);\n        }else{\n            llSay(0, vhCustomTitle+vhMessageLine+\"You spent \"+ (string)vhAccessCost+ \" tokens to use this object.\" +vhCoinString+vhGemString+vhScoreString);\n        }\n                }else{\n                    llSay(1720, \"N\");\n                }\n            }\n        }\n        \n        if (channel == 1791)\n        {\n         if (message == (string)llGetOwner())\n         {\n             // here we should add a list to hold which objects have been acquired. We can do it by storing a list of the \n             // puzzle boards that awarded gems - and simply ignoring repeat awards - (you could add a message to that effect as well.\n            list tTest = [id]; // the uuid of the puzzle board\n            integer foundIndex = llListFindList(pPuzzleList, tTest);\n            if (foundIndex == -1)\n            {   \n                pGems = pGems+1;\n                list insertNameList = [id];\n                pPuzzleList = llListInsertList(pPuzzleList, insertNameList, 0);\n                vhCoinString        = \"\\nTOKENS: \"+(string)pCoins;\n                vhGemString         = \"\\nPRIZES: \"+(string)pGems;\n                pScore = pCoins * pGems;\n                vhScoreString       = \"\\nPOINTS: \"+(string)pScore;\n                if (pHUDworn == 1)\n                {\n                    llSetText(vhCustomTitle+vhMessageLine+\"You earned a prize.\"+vhCoinString+vhGemString+vhScoreString, <0,0,0>, 1);\n                }else{\n                    llInstantMessage(llGetOwner(), vhCustomTitle+vhMessageLine+\"You earned a prize.\"+vhCoinString+vhGemString+vhScoreString);\n                }\n            }else{\n                llInstantMessage(llGetOwner(), \"You have already earned this prize.\");\n            }\n        }else{\n                \n                //llSay(0, message);\n            key tKeyMes = (key)message;\n            list tTest = [tKeyMes];\n                //llSay(0, (string)pPuzzleList);\n                //llSay(0, (string)tTest);\n            integer foundIndex = llListFindList(pPuzzleList, tTest);\n                //llSay(0, (string)foundIndex);\n            llSay(3719, (string)foundIndex);\n        }\n               \n        }\n        if (channel == 1616)\n        {\n            string whoCalled = right(message, \":\");\n            if (whoCalled == \"board\")\n            {\n            llSay(1617, ((string)pCoins + \":\" + (string)pGems));\n        }else{\n            llSay(1417, ((string)pCoins + \":\" + (string)pGems));\n        }\n        }\n        \n        if (channel == 2654)\n        {\n            llSay(2655, \"ScorekeeperReply\");\n        }\n        \n        }\n            dataserver(key _query_id, string _data)\n    {\n        if (_query_id == g_kQuery) {\n            if (_data != EOF) {\n                g_lTempLines += [_data];\n                g_iLine++;\n                g_kQuery = llGetNotecardLine(g_sNoteCardName, g_iLine);\n            } else {\n                    notecardFinished(g_sNoteCardName);\n            }\n        }\n    }\n    \n    }  \n\n",
  "creator": {
    "name": "",
    "uuid": "",
    "grid": ""
  },
  "permissions": {},
  "object_name": ""
}