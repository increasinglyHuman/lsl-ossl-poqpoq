{
  "type": "script",
  "uuid": "9ce87a7d-2b6f-4d58-be63-0f52dc10a407",
  "name": "emailScript",
  "description": "2009-02-22 17:13:12 lsl2 script",
  "source": "key tWhoClicked;\n//----------------------------------------------------------------------------------------//\ninteger llListenHandler;\nstring  tName;\nstring  gsCardOneName = \"config\";\nlist    gOneCard;\nstring  tWho = \"\";\nstring  tGreeting = \"\";\nstring  tComplete = \"\";\nlist    g_lTempLines;\nstring  g_sNoteCardName;\ninteger g_iLine;\nstring  g_kQuery;\nstring  url = \"http://www.p0qp0q.com/cgibin/mcfeeny/mcfeenySimple.php\";\nkey     pOwner;\nstring put_id;\n\n\n// This puts the data to the database (SAVE)\nPutData(string boo2, string who, string msg)\n{\n    string args;\n    args += \"?key=\";\n    boo2 = llEscapeURL(boo2);\n    args += boo2;\n    args +=\"&email=\"+who+\"&message=\";\n    msg = llEscapeURL(msg);\n    args += msg;\n    args += \"&secret=M4g1C14N\";\n    put_id = llHTTPRequest(url+args,[HTTP_METHOD,\"GET\",HTTP_MIMETYPE,\"application/x-www-form-urlencoded\"],\"\");\n}\n\nstring left(string src, string divider) {\n    integer index                       = llSubStringIndex( src, divider );\n    if(~index)\n    {\n        return llDeleteSubString( src, index + llStringLength(divider)-1, -1);\n    }\n    return src;\n}\n\nstring right(string src, string divider) {\n    integer index                       = llSubStringIndex( src, divider );\n    string tString                      = \"\";\n    if (~index)\n    {\n        return llDeleteSubString( src, 0, index + llStringLength(divider) - 1);\n    }\n    return tString;\n}\n\ninitialize(string _action) {\n    if (_action == \"\") {\n        loadNoteCard(gsCardOneName);\n    } else if (_action == \"finish\") {\n        integer i;\n        for (i = 0; i< 4; ++i)\n        {\n            string tLineText        = llList2String(gOneCard,i);\n            if (i == 0)\n            {\n                tWho                = right(tLineText,\":\");\n                if (tWho             == \"yourEmail@yourDomain.com\"); \n                {\n                    llSay(0, \"You have either reset the script or still need to change the email in the config notecard in the contents tab of the editor while the mailbox is selected. After you modify the config notecard, derez (take) the mailbox and then rerez the mailbox\"); \n                }\n            }\n            if (i == 1)\n            {\n                tGreeting           = right(tLineText,\":\");\n            }\n            if (i == 2)\n            {\n                tComplete            = right(tLineText,\":\");\n            }\n        }\n    }\n}\n\nloadNoteCard( string _notecard ) {\n    g_lTempLines                    = [];\n    g_sNoteCardName                 = _notecard;\n    g_iLine                         = 0;\n    g_kQuery                        = llGetNotecardLine(g_sNoteCardName, g_iLine);\n}\n\nnotecardFinished(string _notecard){\n    if (_notecard == gsCardOneName) {\n        gOneCard                 = g_lTempLines;\n        initialize(\"finish\");\n    }\n}\n\ndefault\n{\n    touch_start(integer total_number)\n    {\n        tWhoClicked                         = llDetectedKey(0);\n        llListenHandler                     = llListen(0, \"\", tWhoClicked, \"\");\n        llInstantMessage(tWhoClicked, tGreeting);\n        tName                               = llDetectedName(0);\n    }\n    state_entry()\n    {\n     initialize(\"\");  \n    }\n    listen(integer i, string n, key id, string m) {\n        pOwner = llGetOwner();\n        string boo = (string)pOwner;\n        PutData(boo, tWho, m);\n        llSay(0,tComplete);\n        llListenRemove(llListenHandler);\n    }\n        dataserver(key _query_id, string _data)\n    {\n        if (_query_id == g_kQuery) {\n            if (_data != EOF) {\n                g_lTempLines += [_data];\n                g_iLine++;\n                g_kQuery = llGetNotecardLine(g_sNoteCardName, g_iLine);\n            } else {\n                    notecardFinished(g_sNoteCardName);\n            }\n        }\n    }\n}\n",
  "creator": {
    "name": "Allen Partridge",
    "uuid": "fb65c818-b6e2-4367-8f65-a069ff0443bf",
    "grid": "http://grid.kitely.com:8002"
  },
  "permissions": {
    "base": 2147483647,
    "current": 2147483647,
    "next": 565248,
    "everyone": 0,
    "group": 0
  },
  "object_name": "Outworld Mailbox-ANYGRID"
}