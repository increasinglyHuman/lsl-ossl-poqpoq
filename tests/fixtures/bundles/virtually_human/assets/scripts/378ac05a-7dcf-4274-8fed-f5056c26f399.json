{
  "type": "script",
  "uuid": "378ac05a-7dcf-4274-8fed-f5056c26f399",
  "name": "378ac05a-7dcf-4274-8fed-f5056c26f399_script",
  "description": "",
  "source": "//string pPenalty = \"10\";\n//string pPenaltyMes = \"Ew! Dead Body!-10 for soap.\"; // add some pedagogically appropriate message here\n\nstring pPenalty = \"10\"; // um, change the number to make it worth more or less\nstring pPenaltyMes = \"Follow the gems.\"; // change the text inside quotes to make it say something different\nstring CONTROLLER_ID = \"A\";  \nfloat tAlpha = 0.8;    // set this to 1.0 if you want your object to be fully opaque.   \n                                                 // for the adventurous, you could make a random list and choose different things to say\nstring  gsCardOneName = \"config\";\nlist    gOneCard;\nlist    g_lTempLines;\nstring  g_sNoteCardName;\ninteger g_iLine;\nstring  g_kQuery;\ninteger resetChannel = 3;\ninteger respawnDelay = 30;\nstring  vhUseParticles = \"TRUE\";\nfloat  vhTargetOmega = 0.3;\n\n\n//----------------- PRIVATE -----------------------------\nstring left(string src, string divider) {\n    integer index                       = llSubStringIndex( src, divider );\n    if(~index)\n    {\n        return llDeleteSubString( src, index + llStringLength(divider)-1, -1);\n    }\n    return src;\n}\n\nstring right(string src, string divider) {\n    integer index                       = llSubStringIndex( src, divider );\n    string tString                      = \"\";\n    if (~index)\n    {\n        return llDeleteSubString( src, 0, index + llStringLength(divider) - 1);\n    }\n    return tString;\n}\n\ninitialize(string _action) {\n    if (_action == \"\") {\n        //llSay(0, \"1\");\n        loadNoteCard(gsCardOneName);\n    } else if (_action == \"finish\") {\n        //llSay(0, \"2\");\n        integer i;\n        for (i = 0; i< 7; ++i)\n        {\n            string tLineText        = llList2String(gOneCard,i);\n            if (i == 0)\n            {\n                pPenalty                = right(tLineText,\":\");\n            }\n            if (i == 1)\n            {\n                pPenaltyMes           = right(tLineText,\":\");\n            }\n            if (i == 2)\n            {\n                string tAlphaString       = right(tLineText,\":\");\n                tAlpha                    = (float)tAlphaString;\n            }\n            if (i == 3)\n            {\n                string stresetChannel      = right(tLineText, \":\");\n                resetChannel               = (integer)stresetChannel; \n                integer lHandle5 = llListen(resetChannel, \"\",\"\",\"\");  \n            }\n            if (i == 4)\n            {\n                string stRespawnDelay       = right(tLineText, \":\");\n                respawnDelay                = (integer)stRespawnDelay;\n                //llSay(0, stRespawnDelay);\n            }\n            if (i == 5)\n            {\n                vhUseParticles              = right(tLineText, \":\");\n                if (vhUseParticles == \"TRUE\")\n                    {\n                        llMessageLinked( LINK_SET, TRUE, CONTROLLER_ID, NULL_KEY );\n                    }else{\n                        llMessageLinked( LINK_SET, FALSE, CONTROLLER_ID, NULL_KEY );\n                    }\n            }\n            if (i == 6)\n            {\n                string stvhTargetOmega      = right(tLineText, \":\");\n                vhTargetOmega               = (float)stvhTargetOmega;\n                llTargetOmega(<0,0,vhTargetOmega>, 10, 10);\n            }\n        }\n    }\n}\n\nloadNoteCard( string _notecard ) {\n    g_lTempLines                    = [];\n    g_sNoteCardName                 = _notecard;\n    g_iLine                         = 0;\n    g_kQuery                        = llGetNotecardLine(g_sNoteCardName, g_iLine);\n}\n\nnotecardFinished(string _notecard){\n    if (_notecard == gsCardOneName) {\n        gOneCard                 = g_lTempLines;\n        initialize(\"finish\");\n    }\n}\n//--------------------------------------------\n\n\ndefault\n{\n    state_entry()\n    //\n    {\n        initialize(\"\"); \n        // on stateChange do stuff\n        //integer lHandle5 = llListen(resetChannel, \"\",\"\",\"\");\n        llSetLinkAlpha(LINK_SET, tAlpha, ALL_SIDES);\n         // set entire prim 100% visible.\n        //llTargetOmega(<0,0,vhTargetOmega>, 10, 10); \n        llSetStatus(STATUS_PHANTOM, TRUE);\n        llSetStatus(STATUS_ROTATE_Z, TRUE);\n        llTargetOmega(<0,0,vhTargetOmega>, 10, 10);\n        llVolumeDetect(TRUE);\n    }\n    on_rez(integer start_param)\n    {\n        llSleep(1);\n        initialize(\"\");\n        llSleep(1); \n    }\n    \n    touch_start(integer total_number)\n    { \n        llSay(1718, ((string) llDetectedKey(0) + \":\"+pPenaltyMes + \":\" + pPenalty));\n                \n        if (respawnDelay > 0) \n        {\n         llSetTimerEvent(respawnDelay);\n        }\n    }\n    listen(integer channel, string name, key id, string mes)\n    {\n    \n            if (channel == resetChannel)\n        {\n            initialize(\"\");\n            llSay(0, \"Okay, I reset the token\");\n            llSetLinkAlpha(LINK_SET, 1.0, ALL_SIDES);\n            if (vhUseParticles == \"TRUE\")\n            {\n            llMessageLinked( LINK_SET, TRUE, CONTROLLER_ID, NULL_KEY );\n            }else{\n                llMessageLinked( LINK_SET, FALSE, CONTROLLER_ID, NULL_KEY );\n            }\n            llSetStatus(STATUS_PHANTOM, TRUE);\n            llVolumeDetect(TRUE);\n            //llSetTimerEvent(0); \n            \n            }\n        }\n        //////////\n            \n            \n    \n        timer()\n        {\n            //llResetScript();\n            llSetLinkAlpha(LINK_SET, tAlpha, ALL_SIDES);\n            if (vhUseParticles == \"TRUE\")\n            {\n            llMessageLinked( LINK_SET, TRUE, CONTROLLER_ID, NULL_KEY );\n            }else{\n                llMessageLinked( LINK_SET, FALSE, CONTROLLER_ID, NULL_KEY );\n            }\n            llVolumeDetect(TRUE);\n            llSetStatus(STATUS_PHANTOM, TRUE);\n            llSleep(1);\n            llSetTimerEvent(0);  \n        }\n           dataserver(key _query_id, string _data)\n    {\n        if (_query_id == g_kQuery) {\n            if (_data != EOF) {\n                g_lTempLines += [_data];\n                g_iLine++;\n                g_kQuery = llGetNotecardLine(g_sNoteCardName, g_iLine);\n            } else {\n                    notecardFinished(g_sNoteCardName);\n            }\n        }\n    }\n}\n",
  "creator": {
    "name": "",
    "uuid": "",
    "grid": ""
  },
  "permissions": {},
  "object_name": ""
}